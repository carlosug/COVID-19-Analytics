"0","# Visualisation"
"0","# After preparing the data, we portrait it in various graphs"
"0","# TOP Ten Countries"
"0","# ranking by confirmed cases"
"0","data.latest <- data %>% filter(date ==max(date)) %>%"
"0","                                select(country, date, confirmed, deaths, recovered, remaining.confirmed) %>%"
"0","                                mutate(ranking = dense_rank(desc(confirmed)))"
"0","# top 10 countries incl 11 World"
"0","top.countries <- data.latest %>% filter(ranking <= 11) %>%"
"0","  arrange(ranking) %>% pull(country) %>% as.character()"
"0","top.countries %>% setdiff('World') %>% print()"
"1"," [1]"
"1"," ""China""         "
"1"," ""Italy""         "
"1"," ""Iran""          "
"1"," ""Spain""         "
"1"," ""Germany""       "
"1","
"
"1"," [6]"
"1"," ""US""            "
"1"," ""France""        "
"1"," ""Korea, South""  "
"1"," ""Switzerland""   "
"1"," ""United Kingdom"""
"1","
"
"0","## add 'Others'"
"0","top.countries %<>% c('Others')"
"0","## put all others in a single group of 'Others'"
"0","df <- data.latest %>% filter(!is.na(country) & country!= 'World')%>%"
"0","  mutate(country=ifelse(ranking <= 11, as.character(country), 'Others')) %>%"
"0","  mutate(country=country %>% factor(levels = c(top.countries)))"
"0","df %<>% group_by(country) %>% summarise(confirmed=sum(confirmed))  "
"0","# percentage and label"
"0","df %<>% mutate(per = (100*confirmed/sum(confirmed)) %>% round(1)) %>%"
"0","                 mutate(txt = paste0(country, ': ', confirmed, '(', per, '%)'))"
"0","df %>% ggplot(aes(fill=country)) +"
"0","  geom_bar(aes(x ='', y = per), stat= 'identity') +"
"0","  coord_polar('y', start =0) +"
"0","  xlab('') + ylab('Percentage (%)') +"
"0","  labs(title=paste0('Top 10 Countries with Most Confirmed Cases (', max.date,')')) +"
"0","  scale_fill_discrete(name='Country', labels = df$txt) +"
"0","  theme(legend.title = element_blank(), legend.text = element_text((size=7)))"
